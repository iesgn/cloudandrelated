---
layout: presentacion
title: Deploying applications on OpenShift
tema: white
---
<section>
  <h2>Deploying applications on OpenShift</h2>
  <p>
    Alberto Molina Coballes, José Luis Rodríguez Rodríguez and José Domingo Muñoz Rodríguez
  </p>
  <p><small>Cloud Computing in European schools. Project: 2017-1-ES01-KA202-038471</small></p>
  <p><img src="img/UE.png" width="250px" border="0"/>
    <img src="img/iesvalleinclan.png" width="250px" border="0"/>
  </p>
  <p>
    <a href="http://creativecommons.org/licenses/by-sa/3.0/">
      <img src="img/cc_by_sa.png" width="100px" border="0"/></a>
  </p>
  <p><small>Theme by: <a href="http://lab.hakim.se/reveal-js/#/">reveal.js</a></small></p>
</section>
<section>
<section>
  <h3>OpenShift v3</h3>
</section>
<section>
  <h4>OpenShift v3</h4>
  <ul>
    <li>It simplifies the implementation life cycle of our applications
      offered by Docker.</li>
    <li>The developer only has to focus on the development of the
      application.</li>
    <li>The project will be stored in a git repository.</li>
    <li>When deploying the application, OpenShift will read the source
      code from the repository and a new docker image is created on
      the fly</li>
    <li><strong><a href="https://docs.openshift.com/container-platform/3.11/architecture/core_concepts/builds_and_image_streams.html#source-build">source2image</a></strong></li>
    </ul>
  </ul>
</section>
<section>
  <h4>OpenShift v3</h4>
  <ul>
    <li>It offers us all the advantages of using Kubernetes:
      <ul>
	<li>Error tolerance</li>
	<li>Dynamic Scalability</li>
	<li>Continuous updates</li>
	<li>Automatic deployments</li>
	<li>Routing to the applications</li>
	<li>Load balancing</li>
	<li>Persistent volumes</li>
      </ul>
    <li>But also...</li>
  </ul>
</section>
<section>
  <h4>OpenShift v3</h4>
    <ul>
      <li>Easier management of projects and users</li>
      <li>A set of base images for different programming languages and
	databases</li>
      <li>Automatic name assignment for the applications (resource
	service and ingress controller)</li>
      <li>Easier volume management</li>
      <li>Integrated IC/CD flows</li>
      <li>Metric and monitoring tools</li>
    </ul>
</section>
</section>
<section>
<section>
  <h4>OpenShift resources</h4>
  <ul>
    <li><strong>Projects</strong>: They allow users to organize and
    control their applications.</li>
    <li><strong>Application</strong>: Our applications are a
    kubernetes applications, so they are formed by different
      resources: deployment, pods, service, routes</li>
    <li><strong>Builds</strong>: It's the process used to create the
    image. There are different strategies:</li>
    <ul>
      <li>From an image, from a Dockerfile, ...</li>
      <li>source2image</li>
      <li>Jenkins' pipeline</li>
      <li>...</li>
    </ul>
  </ul>
</section>
<section>
  <h4>Recursos que nos ofrece OpenShift</h4>
  <ul>
      <li><strong>image registry</strong>: The images created in the
      builds are saved in an internal registry</li>
      <li><strong>Routes</strong>: A route (name) is automatically
      associated to access each application</li>
      <li><strong>Service catalog</strong>: Set of images and base
      templates. New images can be built from them using s2i.</li>
      <li><strong>Web Console</strong></li>
      <li><strong>cli oc</strong>: Command line tool to manage
      OpenShift</li>
  </ul>
</section>
</section>
<section>
<section>
  <h4>Creating the first application</h4>
  <ul>
    <li> Let's create a static web application with an apache2 web
      server.</li>
    <li>Our page is in a GitHub repository.</li>
    <li>We are going to create our application using source2image:
    when we create the application we are going to choose an image
    with apache2 and we are going to indicate our repository with the
    code: A docker image with apache2 is selected and the repository
    is used to deploy the application</li>
  </ul>
</section>
<section>
  <h4>Creating the first application</h4>
  <ol>
    <li>From the catalog we chose the image of apache2</li>
    <li>We indicate a name and the repository where the code is
      located</li>
    <li>A build is created:
      <ul>
	<li>A pod is created from the selected apache2 image.</li>
	<li>The repository code is injected into that pod.</li>
	<li>A new image is created with apache2 and our
	  application.</li>
      </ul>
    </li>
  </ol>
</section>
<section>
  <h4>Creamos nuestra primera aplicación</h4>
  <ol start="4">
    <li>From the new image:</li>
    <ul>
      <li>A deployment is created that creates a pod with the
        application.</li>
      <li>An access service to the application is created.</li>
      <li>An access route is created.</li>
    </ul>
    <li>The applications is already deployed and we can access it</li>
  </ol>
</section>
<section>
  <h3>Demo1: static content deployment on OpenShift v3</h3>
  <iframe width="560" height="315" src="https://www.youtube.com/embed/n938MmkxJWA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

</section>
</section>
<section>
<section>
  <h4>Updating and rolling back the application</h4>
  <ol>
    <li>Modify the code and save the changes in the repo.</li>
    <li>Make a new build, creating a new image with the changes.</li>
    <li>A new development will be make automatically, deleting the old
    pods and creating new ones.</li>
    <li>The previous deployment can be deployed when needed, rolling
    back to the first release of the application.</li>
  </ol>
</section>
<section>
  <h4>Updating and rolling back the application</h4>
  <iframe width="560" height="315" src="https://www.youtube.com/embed/xY7W2e1ufWk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</section>
</section>
<section>
  <section>
    <h4>Deploying a python application on OpenShift v3</h4>
    <ol>
      <li>The application is available on a git repo.</li>
      <li>A new application is created,
      selecting <strong>python</strong> from the catalog, choosing
      the right python version and defining the git repo.</li>
      <li>The python dependencies are installed from the
      requirements.txt file</li>
    </ol>
  </section>
  <section>
    <h4>Deploying a python application on OpenShift v3</h4>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/6CjMm7iLdsE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  </section>
</section>

<section>
  <section>
    <h4>Deploying a PHP application on OpenShift v3</h4>
    <ol>
      <li>We're going to show how to deploy a PHP CMS with a sqlite
        database (phpSQLiteCMS)</li>
      <li><a href="https://github.com/ilosuna/phpsqlitecms.git">Github repo</a></li>
      <li>A new application is created, selecting <strong>php</strong>
      from the catalog, choosing the right python version and defining
      the git repo.</li>
      <li>The php dependencies are installed from the composer.json
      file</li>
    </ol>
  </section>
  <section>
    <h4>Deploying a PHP application on OpenShift v3</h4>
    <ol>
      <li>The database is located in the directory /cms/data</li>
      <li>Containers are ephemeral, we don't have persistent
	storage.</li>
      <li>If the applications needs to scale, a new pod from the image
	will be created with a new and clean database</li>
      <li>If a new deployment is made, the new pods will lose the
	data: Persistent volumes needed!</li>
    </ol>
  </section>
  <section>
    <h4>Deploying a PHP application on OpenShift v3</h4>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/loV8Iglhp30" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  </section>
</section>
<section>
  <section>
    <h4>Deploying a PHP application with persistent volumes on OpenShift v3</h4>
    <ol>
      <li>The directory where databases are stored is /cms/data</li>
      <li>A persistent volume must be created and mounted on /cms/data.</li>
      <li>During the first deployment, the persistent volume is mount
      after the launch, so the database files must be copied manually.</li>
    </ol>
  </section>
  <section>
    <h4>Deploying a PHP application with persistent volumes on OpenShift v3</h4>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/z8zkktHbcac" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  </section>
</section>
